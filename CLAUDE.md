# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a kintone customization template project. It uses esbuild for bundling TypeScript/CSS and includes a local HTTPS dev server for development.

## Commands

### Build & Development

```sh
npm run build:dev    # Development mode: starts HTTPS server at https://localhost:9000 with watch
npm run build:prod   # Production build: outputs minified files to dist/
```

Both commands run TypeScript type-checking (`tsc --noEmit`) before building.

### Initial Setup (required once)

```sh
# Generate self-signed SSL certificate for local HTTPS server
mkdir .cert && openssl req -x509 -newkey rsa:4096 -keyout .cert/private.key -out .cert/private.cert -days 9999 -nodes -subj /CN=127.0.0.1
```

### Get kintone App Structure

ดึงโครงสร้าง Form Field จาก kintone App และ generate TypeScript type definitions:

```sh
npm run gen:fields <appId>

# ตัวอย่าง
npm run gen:fields 51
```

Script นี้จะสร้าง 2 ไฟล์:

- `src/js/fields.d.ts` - TypeScript type definitions สำหรับ fields ใน App
- `kintone-app-structure/app_<appId>_formField.json` - โครงสร้าง Form Field แบบ JSON

### Get kintone App List

ดึงรายการ Apps ทั้งหมดจาก kintone:

```sh
npm run get:apps
```

Script นี้จะสร้างไฟล์ `kintone-app-structure/apps.json` ที่มีข้อมูล Apps ทั้งหมด เช่น appId, name, creator, modifier ฯลฯ

### Get kintone Form Layout

ดึงโครงสร้าง Form Layout (การจัดวาง fields) จาก kintone App:

```sh
npm run get:layout <appId>

# ตัวอย่าง
npm run get:layout 51
```

Script นี้จะสร้างไฟล์ `kintone-app-structure/app_<appId>_formLayout.json` ที่มีข้อมูลการจัดวาง fields ใน form

### Environment Variables

Scripts ข้างต้นต้องตั้งค่า `.env` ก่อนใช้งาน (copy จาก `.env.example`):

```sh
cp .env.example .env
# แก้ไขค่าใน .env ให้ตรงกับ kintone environment ของคุณ
```

```env
KINTONE_DOMAIN=xxx.cybozu.com
KINTONE_USERNAME=your_username
KINTONE_PASSWORD=your_password
```

### Linting

Uses `@cybozu/eslint-config` with Prettier integration. Run via:

```sh
npx eslint .
```

## Architecture

- **Entry points**: `src/js/index.ts` (JavaScript) and `src/style/style.css` (styles)
- **Build output**: `dist/` directory
- **Build system**: esbuild with custom serve-mode-plugin for dev server logging
- **Type definitions**: `src/js/fields.d.ts` is auto-generated by `@kintone/dts-gen` for app field types

## Documentation

- **kintone REST API**: ดูเอกสารใน `kintone-rest-api-client-docs`

## Key Dependencies

- `@kintone/rest-api-client`: kintone REST API client
- `kintone-ui-component`: Official kintone UI components
- `sweetalert2`: Modal dialogs
- `dayjs`: Date manipulation

## Code Style

- ESLint: Cybozu preset with Prettier
- Prettier: Uses `trailingComma: "none"` to avoid JSON.parse errors in kintone
- TypeScript: Strict mode enabled with ES2024 target
